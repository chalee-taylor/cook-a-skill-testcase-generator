# TC_UNSPLASH_F10_VISUAL_SEARCH.md â€” Test Cases: Visual Search

**Generated by:** Test Case Generator Skill v1.1.0
**Source Spec:** SPEC_UNSPLASH.md â€” Feature 10
**Feature:** Visual Search
**Coverage Level:** full
**Enable Security:** true
**Generated At:** 2026-02-27
**Output Format:** markdown

---

## Pre-run Report

### Step 0 â€” PII Masking

Scanned spec for PII patterns. No real PII found. All references are synthetic test data.

**PII Masking Report:** Fields redacted: 0

---

### Intelligence Scan Report â€” Visual Search

#### Feature Identified
- **Type:** File Upload + URL-Based Search + AI/ML Processing
- **Name:** Visual Search
- **Language:** English

#### Business Rules Extracted

Total: **7 rules**

| ID | Rule Summary |
|---|---|
| BR-091 | Visual Search available to all users (authenticated and unauthenticated) |
| BR-092 | Users can initiate Visual Search by uploading image (JPEG/PNG) or by entering public image URL |
| BR-093 | Uploaded images for Visual Search: max 20 MB |
| BR-094 | Visual Search returns top 20 most visually similar photos |
| BR-095 | Results can be refined by keyword after initial visual search |
| BR-096 | AI/ML image similarity engine â€” results ranked by similarity score |
| BR-097 | If no similar photos found: "No similar photos found. Try a different image." |

#### User Flows Detected

Total: **2 flows**

1. Happy Path â€” Upload Image (6 steps)
2. Happy Path â€” URL-Based Search (4 steps)

#### Risk Areas Flagged

| Risk Category | Detected? | Evidence |
|---|---|---|
| Authentication / Auth | No | Available to all users |
| Input Validation | **Yes** | File format (JPEG/PNG), file size (max 20 MB), URL accessibility |
| File Upload | **Yes** | JPEG/PNG only, max 20 MB |
| Payment Processing | No | â€” |
| External API / Service | **Yes** | AI/ML image similarity engine |
| PII / Sensitive Data | **Yes** | Uploaded images may contain faces/PII |
| Rate Limiting | No | Not mentioned in spec |
| Permissions / Roles | No | No role distinction |

#### Spec Quality Assessment
- **Confidence: High**
- Has user flow: Yes
- Has business rules: Yes
- Has validation conditions: Yes
- Missing elements: Rate limiting not described; AI/ML engine failure behavior not specified

#### Coverage Recommendation
- **Recommended: `full`** â€” File upload security, URL-based SSRF risk, and AI/ML processing edge cases

#### Estimated Output
- Estimated TC count: ~20 TCs
- Traceability matrix: included

#### Spec Gaps Detected

| Gap Type | Detected? | Impact |
|---|---|---|
| No failure/error scenarios | Partial | AI/ML engine failure not described; marked needs_review |
| No boundary conditions in rules | No | â€” |
| Vague expected behavior | Partial | BR-096: "ranked by visual similarity score" â€” exact result count/order not fully specced |
| External dependency unspecified | **Yes** | AI/ML engine failure scenario not described â€” TC-016 marked needs_review |
| No roles or permissions defined | No | â€” |
| Contradictory rules | No | â€” |
| Only happy path described | No | â€” |

---

## Test Cases â€” Visual Search

### ðŸŸ¢ Happy Path

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-001 | Guest uploads valid JPEG and receives visually similar results | Happy Path | P1 - Critical | BR-091, BR-092, BR-093, BR-094, BR-096 | No active session. Visual Search page is open. | image_file: mountain_photo.jpg (JPEG, 5 MB) | 1. Navigate to Visual Search page (camera icon) 2. Click "Upload image" 3. Select mountain_photo.jpg 4. Wait for processing | Grid of up to 20 visually similar photos displayed. Results are ranked by visual similarity. Each result can be clicked to open Photo Detail page. |
| TC-002 | Registered user uploads valid PNG and receives visually similar results | Happy Path | P1 - Critical | BR-091, BR-092, BR-093, BR-094 | User user@test.com is logged in. | image_file: landscape.png (PNG, 10 MB) | 1. Log in as user@test.com 2. Navigate to Visual Search 3. Upload landscape.png | Up to 20 similar photos displayed. |
| TC-003 | User searches by pasting a valid public image URL | Happy Path | P1 - Critical | BR-091, BR-092, BR-094 | No active session. Visual Search page open. | image_url: https://images.unsplash.com/photo-abc123 (publicly accessible JPEG) | 1. Navigate to Visual Search 2. Click "Paste image URL" option 3. Enter: https://images.unsplash.com/photo-abc123 4. Click "Search" | System fetches and processes the image. Up to 20 visually similar photos displayed. |
| TC-004 | User applies keyword filter to refine visual search results | Happy Path | P2 - High | BR-095 | Visual search results displayed for uploaded image. At least some results visible. | keyword_filter: "mountain" | 1. Complete a visual search with any image 2. In the keyword refinement field, type: mountain 3. Apply filter | Results narrowed by both visual similarity and keyword "mountain". Fewer or more specific results shown. |

### ðŸ”´ Negative

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-005 | Upload rejected for non-JPEG/PNG format (PDF) | Negative | P1 - Critical | BR-092 | Visual Search page is open. | image_file: document.pdf | 1. Navigate to Visual Search 2. Attempt to upload document.pdf | Upload rejected. Error: "Only JPEG and PNG images are supported". No search performed. |
| TC-006 | Upload rejected for file exceeding 20 MB | Negative | P1 - Critical | BR-093 | Visual Search page is open. | image_file: large_image.jpg (21 MB, JPEG) | 1. Navigate to Visual Search 2. Attempt to upload large_image.jpg (21 MB) | Upload rejected. Error: "Image must be 20 MB or smaller". No search performed. |
| TC-007 | URL-based search fails for non-publicly accessible image | Negative | P2 - High | BR-092 | Visual Search URL input is open. | image_url: https://private.internal.example.com/secret.jpg (requires auth) | 1. Navigate to Visual Search 2. Paste URL: https://private.internal.example.com/secret.jpg 3. Click "Search" | Error: "Image URL is not accessible. Please try uploading the image directly." No search performed. |
| TC-008 | URL resolving to non-image file is rejected | Negative | P2 - High | BR-092 | Visual Search URL input is open. | image_url: https://example.com/document.pdf (valid URL, non-image) | 1. Navigate to Visual Search 2. Paste URL for a PDF file 3. Click "Search" | Error: "URL does not point to a valid image". No search performed. |
| TC-009 | No similar photos found shows empty state message | Negative | P2 - High | BR-097 | Visual Search page is open. | image_file: abstract_solid_color.jpg (plain solid red square) | 1. Upload a very abstract or unique image (solid color block) that has no similar photos | Message displayed: "No similar photos found. Try a different image." Grid is empty. |

### ðŸŸ¡ Edge Cases

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-010 | Uploaded image at exactly 20 MB is accepted | Edge Case | P2 - High | BR-093 | Visual Search page is open. | image_file: exactly_20mb.jpg (exactly 20.00 MB, JPEG) | 1. Navigate to Visual Search 2. Upload exactly_20mb.jpg | Upload accepted. Visual search processes the image. Results displayed (or empty state if no matches). No file size error. |
| TC-011 | Uploaded image at 20.1 MB is rejected | Edge Case | P2 - High | BR-093 | Visual Search page is open. | image_file: over_20mb.jpg (20.1 MB, JPEG) | 1. Navigate to Visual Search 2. Attempt to upload over_20mb.jpg | Upload rejected. Error: "Image must be 20 MB or smaller". |
| TC-012 | Very abstract/plain image produces generic results | Edge Case | P3 - Medium | BR-094, BR-096 | Visual Search page is open. | image_file: solid_blue.jpg (solid blue square, JPEG, 1 MB) | 1. Upload solid_blue.jpg | Image processed normally. Results (if any) are visually generic. No error. Empty state shown if no matches. |
| TC-013 | Same image uploaded twice in same session â€” second search runs normally | Edge Case | P3 - Medium | BR-092, BR-094 | Visual Search page is open. | image_file: mountain_photo.jpg (same file, uploaded twice) | 1. Upload mountain_photo.jpg â†’ observe results 2. Upload same mountain_photo.jpg again | Second search completes normally. Results may differ if library has been updated. No error or duplicate rejection. |
| TC-014 | Visual search + keyword filter with 0 combined results shows empty state | Edge Case | P2 - High | BR-095, BR-097 | Visual search results for uploaded image are showing. | keyword_filter: "zzznoresultszzz" (unlikely keyword) | 1. Complete visual search with any image 2. Apply keyword filter: "zzznoresultszzz" | Combined filter returns 0 results. Empty state message displayed for the filtered combination. No crash. |
| TC-015 | URL-based search with image that has authentication requirement shows error | Edge Case | P2 - High | BR-092 | Visual Search URL input open. | image_url: https://login-required.example.com/photo.jpg (behind login wall) | 1. Paste URL behind login wall 2. Click "Search" | Error: "Image URL is not accessible. Please try uploading the image directly." No redirect to login wall. |

### ðŸ”’ Security

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-016 | SSRF â€” Visual Search URL input does not allow requests to internal network | Security | P1 - Critical | BR-092 | Visual Search page is open. | image_url: http://169.254.169.254/latest/meta-data/ (AWS IMDS endpoint) | 1. Navigate to Visual Search 2. Paste URL: http://169.254.169.254/latest/meta-data/ 3. Click "Search" | System blocks the request. Error shown (not accessible or invalid URL). Internal metadata service NOT accessed. No cloud credentials or internal network content returned. |
| TC-017 | SSRF â€” Visual Search URL cannot be used to probe internal IPs | Security | P1 - Critical | BR-092 | Visual Search page is open. | image_url: http://192.168.1.1/admin (internal router IP) | 1. Paste URL: http://192.168.1.1/admin 2. Click "Search" | Request blocked. Error: URL not accessible. Internal IP ranges are blacklisted. No response from internal network. |
| TC-018 | Polyglot image file (JPEG with embedded script) does not execute on server | Security | P1 - Critical | BR-092 | Visual Search page is open. | image_file: polyglot.jpg (valid JPEG + PHP/script appended) | 1. Upload a JPEG with embedded script in EXIF or file trailer 2. Observe server response | Image processed as a static image. Embedded script NOT executed server-side. Results displayed normally (or empty state). No code execution. |
| TC-019 | Path traversal in image URL does not expose server files | Security | P2 - High | BR-092 | Visual Search URL input open. | image_url: https://images.unsplash.com/../../../etc/passwd | 1. Paste URL with path traversal: https://images.unsplash.com/../../../etc/passwd 2. Click "Search" | Error: "Image URL is not accessible" or "URL does not point to a valid image". No server file content returned. |
| TC-020 | Malicious filename in uploaded image does not traverse server filesystem | Security | P1 - Critical | BR-092 | Visual Search page is open. | image_file: named ../../etc/passwd.jpg (valid JPEG content, malicious name) | 1. Upload a valid JPEG with filename: ../../etc/passwd.jpg | File accepted (if valid JPEG). Filename sanitized server-side. File stored with safe name. No path traversal occurs. |

---

## Traceability Matrix

| Rule ID | Rule Description | Covered By | Status |
|---|---|---|---|
| BR-091 | Available to all users | TC-001, TC-003 | âœ… Covered |
| BR-092 | Upload image or enter public URL | TC-001, TC-002, TC-003, TC-005, TC-008, TC-015, TC-016, TC-017, TC-018, TC-019, TC-020 | âœ… Covered |
| BR-093 | Max 20 MB for uploaded images | TC-001, TC-006, TC-010, TC-011 | âœ… Covered |
| BR-094 | Returns top 20 visually similar photos | TC-001, TC-002, TC-003, TC-012, TC-013 | âœ… Covered |
| BR-095 | Results refnable by keyword | TC-004, TC-014 | âœ… Covered |
| BR-096 | AI/ML similarity ranking | TC-001, TC-012 | âœ… Covered |
| BR-097 | Empty state: "No similar photos found" | TC-009, TC-014 | âœ… Covered |

---

## Coverage Summary

| Type | Count |
|---|---|
| ðŸŸ¢ Happy Path | 4 |
| ðŸ”´ Negative | 5 |
| ðŸŸ¡ Edge Case | 6 |
| ðŸ”’ Security | 5 |
| **Total** | **20** |

**Rule Coverage:** 7 / 7 rules = **100%**

---

## Test Execution Report

```
Feature:      Visual Search
Source Spec:  SPEC_UNSPLASH.md â€” Feature 10
Tester:       ___________
Date:         ___________
Environment:  ___________
Build/Version:___________

| Total TCs | Pass | Fail | Blocked | Not Run |
|-----------|------|------|---------|---------|
|    20     |      |      |         |         |

Defects Found:
| Bug ID | TC ID | Rule Ref | Description | Severity | Status |
|--------|-------|----------|-------------|----------|--------|
|        |       |          |             |          |        |

Sign-off:
[ ] QC Lead Review: ___________
[ ] Security Review (if applicable): ___________
[ ] Ready for Release
```
