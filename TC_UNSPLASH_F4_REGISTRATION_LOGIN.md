# TC_UNSPLASH_F4_REGISTRATION_LOGIN.md ‚Äî Test Cases: User Registration & Login

**Generated by:** Test Case Generator Skill v1.1.0
**Source Spec:** SPEC_UNSPLASH.md ‚Äî Feature 4
**Feature:** User Registration & Login
**Coverage Level:** full
**Enable Security:** true
**Generated At:** 2026-02-26
**Output Format:** markdown

---

## Pre-run Report

### Step 0 ‚Äî PII Masking

Scanned spec for PII patterns. Email examples found (`user@test.com`, `locktest@test.com`) are synthetic test data ‚Äî not real PII. No fields redacted.

**PII Masking Report:** Fields redacted: 0

---

### Intelligence Scan Report ‚Äî User Registration & Login

#### Feature Identified
- **Type:** Auth Flow (Registration Form + Login Form + OAuth)
- **Name:** User Registration & Login
- **Language:** English

#### Business Rules Extracted

Total: **15 rules**

| ID | Rule Summary |
|---|---|
| BR-021 | Email must be valid format (RFC 5321) |
| BR-022 | Password minimum 8 characters |
| BR-023 | Password: uppercase + lowercase + digit required |
| BR-024 | Email must be unique across platform |
| BR-025 | Username must be unique platform-wide |
| BR-026 | Username 3‚Äì30 characters |
| BR-027 | Username: alphanumeric + underscore only |
| BR-028 | Username cannot be trademarked brand name |
| BR-029 | Username cannot impersonate another person |
| BR-030 | Account locked 15 min after 5 consecutive failed logins |
| BR-031 | Google OAuth and Facebook OAuth supported |
| BR-032 | Verification email sent on successful registration |
| BR-033 | Error must NOT reveal if email is registered (anti-enumeration) |
| BR-034 | Login error must be generic: "Invalid email or password" |
| BR-035 | ToS acceptance required to complete registration |

#### User Flows Detected

Total: **4 flows**

1. Happy Path ‚Äî Registration (7 steps)
2. Happy Path ‚Äî Login (6 steps)
3. Alternative Flow ‚Äî Account Lockout (3 steps)
4. Alternative Flow ‚Äî OAuth Login / Google (4 steps)

#### Risk Areas Flagged

| Risk Category | Detected? | Evidence |
|---|---|---|
| Authentication / Auth | **Yes** | Login flow, credential validation, session creation |
| Input Validation | **Yes** | Email format, password complexity, username constraints |
| File Upload | No | ‚Äî |
| Payment Processing | No | ‚Äî |
| External API / Service | **Yes** | Google OAuth, Facebook OAuth, verification email delivery |
| PII / Sensitive Data | **Yes** | Email address, password transmitted at login/registration |
| Rate Limiting | **Yes** | "5 consecutive failed attempts ‚Üí lock 15 min" (BR-030) |
| Permissions / Roles | **Yes** | "authenticated", "guest", implicit role distinction |

#### Spec Quality Assessment
- **Confidence: High**
- Has user flow: Yes
- Has business rules: Yes
- Has validation conditions: Yes
- Missing elements: None critical

#### Coverage Recommendation
- **Recommended: `full`** ‚Äî feature has auth, rate limiting, anti-enumeration, OAuth external dependency, and PII handling

#### Estimated Output
- Estimated TC count: ~29 TCs
- Traceability matrix: included

#### Spec Gaps Detected

| Gap Type | Detected? | Impact |
|---|---|---|
| No failure/error scenarios | No | ‚Äî |
| No boundary conditions in rules | No | ‚Äî |
| Vague expected behavior | Partial | BR-032: "verification email sent" ‚Äî content/format not described; TC marked `needs_review` |
| External dependency unspecified | Yes | OAuth failure scenario (provider unavailable) not described in spec |
| No roles or permissions defined | No | ‚Äî |
| Contradictory rules | No | ‚Äî |
| Only happy path described | No | ‚Äî |

---

## Test Cases ‚Äî User Registration & Login

### üü¢ Happy Path

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-001 | Register with all valid fields and ToS accepted | Happy Path | P1 - Critical | BR-021, BR-022, BR-023, BR-024, BR-025, BR-026, BR-027, BR-032, BR-035 | No active session. /join is open. Email newuser@test.com does not exist. | first_name: John / last_name: Doe / email: newuser@test.com / username: john_doe99 / password: Test@1234 / tos: checked | 1. Navigate to https://unsplash.com/join 2. Enter first_name: John 3. Enter last_name: Doe 4. Enter email: newuser@test.com 5. Enter username: john_doe99 6. Enter password: Test@1234 7. Check ToS checkbox 8. Click "Join" | Account created. User redirected to homepage as logged in. Verification email sent to newuser@test.com. |
| TC-002 | Login with valid email and correct password | Happy Path | P1 - Critical | BR-021, BR-034 | Account user@test.com exists and is active. No active session. /login is open. | email: user@test.com / password: Test@1234 | 1. Navigate to https://unsplash.com/login 2. Enter email: user@test.com 3. Enter password: Test@1234 4. Click "Login" | User redirected to homepage as logged in. No error message shown. |

### üî¥ Negative

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-003 | Registration blocked when email is already registered | Negative | P1 - Critical | BR-024, BR-033 | Account for existing@test.com already exists. /join is open. | email: existing@test.com / username: newuser_99 / password: Test@1234 / tos: checked | 1. Navigate to /join 2. Fill all fields; use email: existing@test.com 3. Check ToS 4. Click "Join" | Registration fails. Inline error on email field. Error does NOT state "email already registered" (anti-enumeration). No account created. |
| TC-004 | Registration blocked when username is already taken | Negative | P2 - High | BR-025 | Account with username "taken_user" exists. /join is open. | email: janesmith@test.com / username: taken_user / password: Test@1234 / tos: checked | 1. Navigate to /join 2. Fill all fields; use username: taken_user 3. Click "Join" | Registration fails. Inline error on username: "Username is already taken". No account created. |
| TC-005 | Registration blocked when password is 7 characters (below minimum) | Negative | P2 - High | BR-022 | /join is open. No active session. | password: Pass123 (7 chars) | 1. Navigate to /join 2. Fill all fields; enter password: Pass123 3. Check ToS 4. Click "Join" | Registration fails. Inline error on password field: "Password must be at least 8 characters". No account created. |
| TC-006 | Registration blocked when password has no digit | Negative | P2 - High | BR-023 | /join is open. No active session. | password: Password (8 chars, uppercase + lowercase, no digit) | 1. Navigate to /join 2. Fill all fields; enter password: Password 3. Check ToS 4. Click "Join" | Registration fails. Inline error on password field indicating digit requirement not met. No account created. |
| TC-007 | Registration blocked when ToS checkbox is unchecked | Negative | P1 - Critical | BR-035 | /join is open. No active session. | All fields valid; tos_accepted: false (unchecked) | 1. Navigate to /join 2. Fill all required fields with valid data 3. Leave ToS checkbox unchecked 4. Click "Join" | "Join" button is disabled, OR server returns 400. Checkbox is highlighted. No account created. |
| TC-008 | Login rejected when password is incorrect | Negative | P1 - Critical | BR-034 | Account user@test.com exists and is active. /login is open. | email: user@test.com / password: WrongPass999 | 1. Navigate to /login 2. Enter email: user@test.com 3. Enter password: WrongPass999 4. Click "Login" | Login fails. Error: "Invalid email or password". User stays on /login. No session cookie set. |
| TC-009 | Login rejected when email is not registered ‚Äî error identical to wrong password | Negative | P1 - Critical | BR-033, BR-034 | No account for ghost@test.com. /login is open. | email: ghost@test.com / password: AnyPassword1 | 1. Navigate to /login 2. Enter email: ghost@test.com 3. Enter password: AnyPassword1 4. Click "Login" | Login fails. Error: "Invalid email or password" ‚Äî identical wording to TC-008. No difference in message that reveals this email is unregistered. |
| TC-010 | Account locked after 5 consecutive failed login attempts | Negative | P1 - Critical | BR-030 | Account locktest@test.com exists and is active. /login is open. | email: locktest@test.com / password: WrongPass! (same wrong password, all 5 attempts) | 1. Navigate to /login 2. Attempt 1: locktest@test.com / WrongPass! ‚Üí fail 3. Attempt 2‚Äì4: same credentials ‚Üí fail 4. Attempt 5: locktest@test.com / WrongPass! ‚Üí fail | On 5th attempt: "Your account has been temporarily locked. Please try again in 15 minutes." Login blocked. No redirect. |
| TC-011 | Registration blocked when required field is empty | Negative | P2 - High | BR-021, BR-026 | /join is open. No active session. | first_name: (empty) / all other fields valid / tos: checked | 1. Navigate to /join 2. Leave first_name blank 3. Fill all other fields with valid data 4. Check ToS 5. Click "Join" | Registration fails. Inline validation error on first_name: field is required. No account created. |

### üü° Edge Cases

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-012 | Password at exactly 8 characters (minimum boundary) is accepted | Edge Case | P2 - High | BR-022 | /join is open. No active session. | password: Abcd1234 (exactly 8 chars: 1 uppercase, lowercase, digit) | 1. Navigate to /join 2. Fill all fields; enter password: Abcd1234 3. Check ToS 4. Click "Join" | Registration succeeds. No password error shown. |
| TC-013 | Username at exactly 3 characters (minimum boundary) is accepted | Edge Case | P2 - High | BR-026 | /join is open. Username "abc" is not taken. | username: abc (3 chars) | 1. Navigate to /join 2. Fill all fields; enter username: abc 3. Check ToS 4. Click "Join" | Registration succeeds. No username error shown. |
| TC-014 | Username at exactly 30 characters (maximum boundary) is accepted | Edge Case | P2 - High | BR-026 | /join is open. 30-char username not taken. | username: abcdefghijklmnopqrstuvwxyz1234 (30 chars) | 1. Navigate to /join 2. Enter username: abcdefghijklmnopqrstuvwxyz1234 3. Fill remaining fields; check ToS 4. Click "Join" | Registration succeeds. No username error shown. |
| TC-015 | Username at 31 characters (one above maximum) is rejected | Edge Case | P2 - High | BR-026 | /join is open. No active session. | username: abcdefghijklmnopqrstuvwxyz12345 (31 chars) | 1. Navigate to /join 2. Enter username: abcdefghijklmnopqrstuvwxyz12345 3. Fill remaining fields; check ToS 4. Click "Join" | Registration fails. Inline error on username: "Username cannot exceed 30 characters". No account created. |
| TC-016 | Email with leading/trailing whitespace is trimmed before validation | Edge Case | P2 - High | BR-021 | /join is open. No account for trimtest@test.com. | email: "  trimtest@test.com  " (2 spaces each side) | 1. Navigate to /join 2. Enter email with surrounding spaces: "  trimtest@test.com  " 3. Fill remaining fields; check ToS 4. Click "Join" | System trims spaces. Registration succeeds with email stored as trimtest@test.com. No email format error. |
| TC-017 | Login blocked with correct password during active lockout period | Edge Case | P1 - Critical | BR-030 | Account locktest@test.com was just locked (5th failed attempt within last minute). | email: locktest@test.com / password: Test@1234 (correct password) | 1. Navigate to /login 2. Enter email: locktest@test.com 3. Enter correct password: Test@1234 4. Click "Login" | Login blocked despite correct password. Lockout message: "Your account has been temporarily locked. Please try again in 15 minutes." No session created. |
| TC-018 | OAuth login with Google creates new account for first-time user | Edge Case | P1 - Critical | BR-031 | No Unsplash account linked to google_user@gmail.com. No active session. | Google account: google_user@gmail.com | 1. Navigate to /login 2. Click "Continue with Google" 3. Sign in with google_user@gmail.com on Google OAuth screen and grant permission 4. Return to Unsplash | Account created and linked to google_user@gmail.com. User redirected to homepage as logged in. No password required. |
| TC-019 | OAuth login with email matching existing password account prompts account link | Edge Case | P1 - Critical | BR-031 | Unsplash account for pw_user@test.com exists (email/password). No active session. | Google account: pw_user@test.com (same email as existing account) | 1. Navigate to /login 2. Click "Continue with Google" 3. Authenticate with pw_user@test.com on Google OAuth 4. Return to Unsplash | System links OAuth to existing account OR displays a prompt to link/merge accounts. No silent duplicate account created. |
| TC-020 | Registration blocked when username contains a space | Edge Case | P2 - High | BR-027 | /join is open. No active session. | username: hello world (contains space) | 1. Navigate to /join 2. Enter username: hello world 3. Fill remaining fields; check ToS 4. Click "Join" | Registration fails. Inline error on username: spaces are not allowed. No account created. |
| TC-021 | Double-submit registration does not create duplicate accounts | Edge Case | P2 - High | BR-024 | /join is open. No account for dbl@test.com. | email: dbl@test.com / username: dbl_user / password: Test@1234 / tos: checked | 1. Navigate to /join 2. Fill all fields; check ToS 3. Double-click "Join" rapidly | Only one account created for dbl@test.com. No duplicate. No server error from the race condition. |

### üîí Security

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-022 | SQL injection in login email field does not expose DB errors | Security | P1 - Critical | BR-021, BR-033 | /login is open. No active session. | email: `' OR '1'='1'--` / password: anything | 1. Navigate to /login 2. Enter in email field: `' OR '1'='1'--` 3. Enter password: anything 4. Click "Login" | Login fails. Error: "Invalid email or password". No SQL error, stack trace, or DB schema exposed in response or page source. No unauthorized session created. |
| TC-023 | SQL injection in registration username field is rejected and sanitized | Security | P1 - Critical | BR-027 | /join is open. No active session. | username: `'; DROP TABLE users;--` | 1. Navigate to /join 2. Fill all fields; enter username: `'; DROP TABLE users;--` 3. Check ToS 4. Click "Join" | Registration fails with username format validation error. No SQL error exposed. Payload not executed. System continues to function normally. |
| TC-024 | XSS payload in username field is not executed | Security | P1 - Critical | BR-027 | /join is open. No active session. | username: `<script>alert('XSS')</script>` | 1. Navigate to /join 2. Enter username: `<script>alert('XSS')</script>` 3. Fill remaining fields; check ToS 4. Click "Join" | Registration fails with username format error. Script NOT executed in browser. No JS alert triggered. Payload not stored in DB. |
| TC-025 | Brute force ‚Äî lockout activates at attempt 5, correct password blocked at attempt 6 | Security | P1 - Critical | BR-030, BR-034 | Account brute@test.com exists and is active. /login is open. | email: brute@test.com / wrong passwords: Wrong1!‚ÄìWrong5! / correct password for attempt 6: Test@1234 | 1. Attempt 1: brute@test.com / Wrong1! ‚Üí fail 2. Attempt 2: Wrong2! ‚Üí fail 3. Attempt 3: Wrong3! ‚Üí fail 4. Attempt 4: Wrong4! ‚Üí fail 5. Attempt 5: Wrong5! ‚Üí fail (account locks) 6. Attempt 6: correct password Test@1234 | Attempt 5 locks account: "Your account has been temporarily locked. Please try again in 15 minutes." Attempt 6 with correct password also blocked. No session created. |
| TC-026 | Account enumeration ‚Äî error message identical for wrong email vs wrong password | Security | P1 - Critical | BR-033, BR-034 | Account real@test.com exists. No account for fake@test.com. /login is open. | Attempt A: real@test.com / WrongPass1. Attempt B: fake@test.com / AnyPass1. | 1. Login with real@test.com / WrongPass1 ‚Üí record full error message and HTTP status 2. Login with fake@test.com / AnyPass1 ‚Üí record full error message and HTTP status 3. Compare both responses | Both return identical error: "Invalid email or password". HTTP status codes are the same. Response time does not differ by > 200ms. No information leaked about which email is registered. |
| TC-027 | New session token issued after login ‚Äî session fixation not possible | Security | P1 - Critical | BR-034 | /login is open. No active session. | email: user@test.com / password: Test@1234 | 1. Open /login and record session cookie value (pre-login) 2. Enter email: user@test.com / password: Test@1234 3. Click "Login" 4. After redirect, record new session cookie value 5. Compare pre-login and post-login tokens | Post-login session token is different from pre-login token. Old pre-login token is no longer valid. Session fixation attack is not possible. |
| TC-028 | OAuth CSRF ‚Äî modified state parameter is rejected | Security | P1 - Critical | BR-031 | /login is open. No active session. Browser proxy available to intercept requests. | OAuth redirect URL with state parameter tampered. | 1. Click "Continue with Google" on /login 2. Intercept the OAuth redirect URL 3. Modify the `state` parameter to an arbitrary value 4. Complete OAuth flow and return to Unsplash | Unsplash detects the invalid state parameter. OAuth callback rejected. Error: "Authentication failed" or similar. No account created or linked. |
| TC-029 | Password not transmitted in URL query string | Security | P2 - High | BR-022, BR-034 | /login is open. No active session. Browser DevTools open on Network tab. | email: user@test.com / password: Test@1234 | 1. Navigate to /login 2. Open DevTools ‚Üí Network tab 3. Enter email: user@test.com / password: Test@1234 4. Click "Login" 5. Inspect: URL bar, browser history, and login request in Network tab | Password Test@1234 is NOT in the URL or query string. Login request uses POST method. Password not visible in browser address bar or history. |

---

## Traceability Matrix

| Rule ID | Rule Description | Covered By | Status |
|---|---|---|---|
| BR-021 | Email must be valid format | TC-001, TC-003, TC-016, TC-022 | ‚úÖ Covered |
| BR-022 | Password minimum 8 characters | TC-001, TC-005, TC-012, TC-029 | ‚úÖ Covered |
| BR-023 | Password: uppercase + lowercase + digit | TC-001, TC-006 | ‚úÖ Covered |
| BR-024 | Email must be unique | TC-001, TC-003, TC-021 | ‚úÖ Covered |
| BR-025 | Username must be unique | TC-001, TC-004 | ‚úÖ Covered |
| BR-026 | Username 3‚Äì30 characters | TC-001, TC-013, TC-014, TC-015 | ‚úÖ Covered |
| BR-027 | Username: alphanumeric + underscore only | TC-001, TC-020, TC-023, TC-024 | ‚úÖ Covered |
| BR-028 | Username cannot be trademarked brand | ‚Äî | ‚ö†Ô∏è Not Covered |
| BR-029 | Username cannot impersonate others | ‚Äî | ‚ö†Ô∏è Not Covered |
| BR-030 | Account locked 15 min after 5 failed logins | TC-010, TC-017, TC-025 | ‚úÖ Covered |
| BR-031 | Google + Facebook OAuth supported | TC-018, TC-019, TC-028 | ‚úÖ Covered |
| BR-032 | Verification email sent on registration | TC-001 | ‚úÖ Covered |
| BR-033 | Error must not reveal email existence | TC-003, TC-009, TC-026 | ‚úÖ Covered |
| BR-034 | Generic login error message | TC-002, TC-008, TC-009, TC-026, TC-027, TC-029 | ‚úÖ Covered |
| BR-035 | ToS acceptance required | TC-001, TC-007 | ‚úÖ Covered |

### Coverage Gap ‚Äî BR-028 v√† BR-029

```
‚ö†Ô∏è COVERAGE GAP: BR-028 "Username cannot be trademarked brand name"
                  BR-029 "Username cannot impersonate another person"

Reason: Both rules describe a content moderation policy enforced by admin review,
        not a system-level validation triggered by user input. No automated or manual
        test can reliably verify these rules without knowing the full trademark list
        or moderation workflow.

Action: Add to spec:
  - The exact mechanism (blocklist-based? admin flag? automated trademark API?)
  - The error message shown when a username is rejected for this reason
  Without this, no testable TC can be written.
```

---

## Coverage Summary

| Type | Count |
|---|---|
| üü¢ Happy Path | 2 |
| üî¥ Negative | 9 |
| üü° Edge Case | 10 |
| üîí Security | 8 |
| **Total** | **29** |

**Rule Coverage:** 13 / 15 rules = **86.7%**
**Uncovered:** BR-028, BR-029 ‚Äî content moderation rules, untestable without additional spec detail

---

## Test Execution Report

```
Feature:      User Registration & Login
Source Spec:  SPEC_UNSPLASH.md ‚Äî Feature 4
Tester:       ___________
Date:         ___________
Environment:  ___________
Build/Version:___________

| Total TCs | Pass | Fail | Blocked | Not Run |
|-----------|------|------|---------|---------|
|    29     |      |      |         |         |

Defects Found:
| Bug ID | TC ID | Rule Ref | Description | Severity | Status |
|--------|-------|----------|-------------|----------|--------|
|        |       |          |             |          |        |

Sign-off:
[ ] QC Lead Review: ___________
[ ] Security Review (TC-022 to TC-029): ___________
[ ] Ready for Release
```
