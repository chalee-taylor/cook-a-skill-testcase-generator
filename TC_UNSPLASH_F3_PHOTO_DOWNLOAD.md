# TC_UNSPLASH_F3_PHOTO_DOWNLOAD.md ‚Äî Test Cases: Photo Download

**Generated by:** Test Case Generator Skill v1.1.0
**Source Spec:** SPEC_UNSPLASH.md ‚Äî Feature 3
**Feature:** Photo Download
**Coverage Level:** full
**Enable Security:** true
**Generated At:** 2026-02-27
**Output Format:** markdown

---

## Pre-run Report

### Step 0 ‚Äî PII Masking

Scanned spec for PII patterns. No real PII found. All references are feature-level test data.

**PII Masking Report:** Fields redacted: 0

---

### Intelligence Scan Report ‚Äî Photo Download

#### Feature Identified
- **Type:** File Download + Access Control (Subscription Gate)
- **Name:** Photo Download
- **Language:** English

#### Business Rules Extracted

Total: **10 rules**

| ID | Rule Summary |
|---|---|
| BR-011 | Guest users can download free photos without an account |
| BR-012 | Free photo downloads do not require attribution (encouraged) |
| BR-013 | Download button labeled "Download free"; lock icon for Unsplash+ premium |
| BR-014 | Download size options: Small, Medium, Large, Original (free photos) |
| BR-015 | Unsplash+ photos require active subscription to download without watermark |
| BR-016 | Download increments photo's download count by 1 |
| BR-017 | Downloaded photos provided in JPEG format |
| BR-018 | Platform tracks download events for analytics |
| BR-019 | Users cannot resell downloaded photos on competing stock platforms |
| BR-020 | Users cannot redistribute photos as part of competing stock service |

#### User Flows Detected

Total: **3 flows**

1. Happy Path ‚Äî Free Photo Download (8 steps)
2. Alternative Flow ‚Äî Premium Photo (Active Subscriber) (4 steps)
3. Alternative Flow ‚Äî Premium Photo (No Subscription) (4 steps)

#### Risk Areas Flagged

| Risk Category | Detected? | Evidence |
|---|---|---|
| Authentication / Auth | **Yes** | Subscriber vs. non-subscriber gate for premium photos |
| Input Validation | **Yes** | Size selection, photo_id validity |
| File Upload | No | ‚Äî |
| Payment Processing | No | ‚Äî |
| External API / Service | No | ‚Äî |
| PII / Sensitive Data | No | ‚Äî |
| Rate Limiting | No | ‚Äî |
| Permissions / Roles | **Yes** | Guest / Registered User / Unsplash+ Subscriber role distinctions |

#### Spec Quality Assessment
- **Confidence: High**
- Has user flow: Yes
- Has business rules: Yes
- Has validation conditions: Yes
- Missing elements: BR-019 and BR-020 are policy rules ‚Äî not testable by automated or manual UI test

#### Coverage Recommendation
- **Recommended: `full`** ‚Äî Multi-role access control, download gate, and IDOR risk on photo IDs

#### Estimated Output
- Estimated TC count: ~22 TCs
- Traceability matrix: included

#### Spec Gaps Detected

| Gap Type | Detected? | Impact |
|---|---|---|
| No failure/error scenarios | Partial | Mid-download network drop is mentioned; browser-level behavior |
| No boundary conditions in rules | No | ‚Äî |
| Vague expected behavior | Partial | BR-012: "attribution encouraged" ‚Äî not verifiable; skipped |
| External dependency unspecified | No | ‚Äî |
| No roles or permissions defined | No | ‚Äî |
| Contradictory rules | No | ‚Äî |
| Only happy path described | No | ‚Äî |

---

## Test Cases ‚Äî Photo Download

### üü¢ Happy Path

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-001 | Guest user downloads free photo at Original size | Happy Path | P1 - Critical | BR-011, BR-013, BR-014, BR-016, BR-017 | No active session. Photo Detail page for free photo ID "abc123" is open. | photo_id: abc123 / size: Original / user_role: Guest | 1. Navigate to Photo Detail page for photo ID: abc123 2. Click "Download free" button 3. Select "Original" from size dropdown | Browser initiates JPEG file download. File saved to device at original resolution. Download count on the photo increments by 1. |
| TC-002 | Guest user downloads free photo at Small size | Happy Path | P2 - High | BR-011, BR-014, BR-017 | No active session. Photo Detail page for free photo "abc123" is open. | size: Small / user_role: Guest | 1. Navigate to Photo Detail page 2. Click "Download free" button 3. Select "Small" from dropdown | Browser initiates JPEG download at small resolution. Download count increments by 1. |
| TC-003 | Registered user downloads free photo at Large size | Happy Path | P2 - High | BR-014, BR-017 | User user@test.com is logged in. Photo Detail page for free photo "abc123" is open. | size: Large / user_role: Registered User | 1. Navigate to Photo Detail page 2. Click "Download free" 3. Select "Large" | Browser initiates JPEG download at large resolution. Download count increments by 1. |
| TC-004 | Active Unsplash+ subscriber downloads premium photo | Happy Path | P1 - Critical | BR-015, BR-083, BR-017 | User subscriber@test.com has active Unsplash+ subscription. Photo Detail page for premium photo "prem001" is open. | photo_id: prem001 / user_role: Unsplash+ Subscriber | 1. Log in as subscriber@test.com 2. Navigate to Photo Detail page for premium photo prem001 3. Click download button | Download initiates at full quality without watermark. JPEG file saved to device. Download count increments. |
| TC-005 | Clicking photo thumbnail opens Photo Detail with stats and download button | Happy Path | P1 - Critical | BR-013, BR-016 | https://unsplash.com/ search results for "mountain" is open. | ‚Äî | 1. Click any photo thumbnail from search results 2. Observe Photo Detail page | Photo Detail page opens showing: full-size photo, photographer info, download count, likes count, views count, "Download free" button. |

### üî¥ Negative

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-006 | Non-subscriber clicking premium (locked) photo download is redirected to subscription page | Negative | P1 - Critical | BR-015, BR-013 | No active Unsplash+ subscription. Photo Detail page for premium photo "prem001" is open. | photo_id: prem001 / user_role: Guest | 1. Navigate to Photo Detail for premium photo prem001 (lock icon visible) 2. Click the download/lock button | User is redirected to https://unsplash.com/plus. Lock icon is shown on photo. No download file is initiated. |
| TC-007 | Download button disabled for deleted photo | Negative | P2 - High | BR-013 | Photo "deleted001" has been removed by contributor. | photo_id: deleted001 | 1. Navigate to Photo Detail page for deleted photo 2. Attempt to click download button | Download button is disabled or greyed out. Message: "Photo no longer available" is shown. No file download initiated. |
| TC-008 | Registered user without subscription cannot download premium photo | Negative | P1 - Critical | BR-015 | User user@test.com is logged in with no Unsplash+ subscription. | photo_id: prem001 / user_role: Registered User (no subscription) | 1. Log in as user@test.com 2. Navigate to Photo Detail for premium photo prem001 3. Click download button | Redirect to https://unsplash.com/plus. No download initiated. Lock icon displayed. |

### üü° Edge Cases

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-009 | Requested size exceeds original resolution ‚Äî that size is hidden | Edge Case | P2 - High | BR-014 | Photo "lowres001" has maximum resolution "Small" (original is smaller than Medium). | photo_id: lowres001 | 1. Navigate to Photo Detail for lowres001 2. Click "Download free" and observe size dropdown | Sizes that exceed the photo's original resolution are not shown in the dropdown. Only valid size options (up to Original) are displayed. |
| TC-010 | Guest downloads same free photo multiple times ‚Äî all succeed | Edge Case | P2 - High | BR-011, BR-016 | No active session. Photo Detail for "abc123" is open. | photo_id: abc123 / user_role: Guest | 1. Click "Download free" ‚Üí select Original ‚Üí download 2. Repeat the same action 3 more times | All 4 downloads succeed. Each download increments the count by 1. Total count increases by 4. No rate limit or block for repeat downloads. |
| TC-011 | Subscriber's subscription expires mid-session ‚Äî next premium download is gated | Edge Case | P1 - Critical | BR-015 | Subscription for subscriber@test.com expired during active session. | photo_id: prem002 | 1. Log in as subscriber@test.com before subscription expires 2. Keep session active until subscription expires (or simulate expiry) 3. Navigate to a premium photo and attempt download | Download gate is re-checked. Non-expired download may complete; next attempt shows subscription gate and redirects to /plus. |
| TC-012 | Download without selecting size defaults to Original or prompts selection | Edge Case | P2 - High | BR-014 | No active session. Photo Detail for "abc123" is open. | ‚Äî | 1. Navigate to Photo Detail for abc123 2. Click the main "Download free" button without opening the size dropdown | Either: (a) file downloads at Original size by default, OR (b) size selection dropdown is prompted. No ambiguous state. |
| TC-013 | Download count is accurate after multiple concurrent downloads | Edge Case | P2 - High | BR-016, BR-018 | Photo "abc123" has download count = 100. | ‚Äî | 1. Open Photo Detail for abc123 in 3 separate browser tabs (3 guest sessions) 2. Initiate download simultaneously from all 3 tabs 3. Refresh the photo page and check download count | Download count increments accurately to 103 (or within 1-2 of expected due to eventual consistency). No count remains at 100. |
| TC-014 | Subscriber downloads premium photo without watermark | Edge Case | P1 - Critical | BR-015, BR-017 | Active Unsplash+ subscriber logged in. | photo_id: prem001 | 1. Log in as subscriber with active subscription 2. Navigate to premium photo prem001 3. Download at Original size | Downloaded JPEG file does not contain watermark overlay. Full quality image delivered. |

### üîí Security

| ID | Title | Type | Priority | Rule Ref | Precondition | Test Data | Steps | Expected Result |
|---|---|---|---|---|---|---|---|---|
| TC-015 | IDOR ‚Äî guest cannot download premium photo by guessing direct file URL | Security | P1 - Critical | BR-015 | No active session. Direct CDN URL for premium photo "prem001" is known. | URL: direct CDN download URL for prem001 | 1. Without authenticating, navigate directly to the CDN download URL for premium photo prem001 | Access denied. System returns 401/403 or serves watermarked version. Subscription check is enforced at the download endpoint, not just on the UI button. |
| TC-016 | Download endpoint enforces subscription check server-side | Security | P1 - Critical | BR-015 | Browser with intercepted request. Non-subscriber session cookie. | Intercept download request for prem001; replay with non-subscriber session. | 1. Capture download request for premium photo using browser DevTools 2. As non-subscriber, replay the same download request | Server returns 401/403 or watermarked photo. Subscription gate is enforced server-side. Removing the lock icon in browser DOM does not bypass the gate. |
| TC-017 | Photo ID manipulation in download URL does not expose private content | Security | P2 - High | BR-011 | No active session. Browsing public photos. | Modified photo_id in download request | 1. Download a public photo and capture the download request 2. Modify the photo_id parameter to an arbitrary unknown value 3. Replay the modified request | System returns 404 if photo does not exist. Returns 403 if photo is private. No exposure of a different user's private or premium-only photo. |
| TC-018 | Path traversal in size parameter does not expose server files | Security | P2 - High | BR-014 | No active session. Photo Detail for "abc123" is open. | size: ../../etc/passwd | 1. Intercept download request for abc123 2. Modify size parameter to: ../../etc/passwd 3. Send modified request | System returns 400 Bad Request or ignores invalid size. No server file system content returned. Only valid size enum values are accepted. |
| TC-019 | Download analytics tracking does not leak user PII in request payload | Security | P2 - High | BR-018 | No active session (guest download). | photo_id: abc123 / size: Original | 1. Download a free photo as a guest 2. Inspect the analytics tracking request in browser DevTools (Network tab) | Analytics event does not include user PII (name, email, IP shown to user). Request payload limited to photo_id, size, and anonymous session token (if any). |

---

## Traceability Matrix

| Rule ID | Rule Description | Covered By | Status |
|---|---|---|---|
| BR-011 | Guest users can download free photos | TC-001, TC-002, TC-010, TC-015 | ‚úÖ Covered |
| BR-012 | Attribution encouraged, not required | ‚Äî | ‚ö†Ô∏è Policy rule ‚Äî not testable via UI |
| BR-013 | Download label / lock icon | TC-001, TC-005, TC-006, TC-007 | ‚úÖ Covered |
| BR-014 | Size options: Small, Medium, Large, Original | TC-001, TC-002, TC-003, TC-009, TC-012, TC-018 | ‚úÖ Covered |
| BR-015 | Unsplash+ required for premium photos | TC-004, TC-006, TC-008, TC-011, TC-014, TC-015, TC-016 | ‚úÖ Covered |
| BR-016 | Download increments count by 1 | TC-001, TC-002, TC-003, TC-010, TC-013 | ‚úÖ Covered |
| BR-017 | Downloads in JPEG format | TC-001, TC-004, TC-014 | ‚úÖ Covered |
| BR-018 | Analytics tracking of downloads | TC-013, TC-019 | ‚úÖ Covered |
| BR-019 | Cannot resell on competing platforms | ‚Äî | ‚ö†Ô∏è Policy/legal rule ‚Äî not testable via UI |
| BR-020 | Cannot redistribute as competing stock service | ‚Äî | ‚ö†Ô∏è Policy/legal rule ‚Äî not testable via UI |

### Coverage Gaps ‚Äî BR-012, BR-019, BR-020

```
‚ö†Ô∏è COVERAGE GAP: BR-012, BR-019, BR-020

Gap type: Policy / Legal rules
Affected TC types: All
Impact: These rules describe legal terms and community guidelines enforced through
        ToS acceptance and moderation, not system-level validations triggered by
        user input. No automated or manual UI test can verify compliance.

Action: Document these as legal/policy acceptance rules in the spec. Add a
        registration/ToS acceptance TC reference (covered by Feature 4 ‚Äî BR-035).
```

---

## Coverage Summary

| Type | Count |
|---|---|
| üü¢ Happy Path | 5 |
| üî¥ Negative | 3 |
| üü° Edge Case | 6 |
| üîí Security | 5 |
| **Total** | **19** |

**Rule Coverage:** 7 / 10 rules = **70%**
**Uncovered:** BR-012, BR-019, BR-020 ‚Äî policy/legal rules, not testable via UI

---

## Test Execution Report

```
Feature:      Photo Download
Source Spec:  SPEC_UNSPLASH.md ‚Äî Feature 3
Tester:       ___________
Date:         ___________
Environment:  ___________
Build/Version:___________

| Total TCs | Pass | Fail | Blocked | Not Run |
|-----------|------|------|---------|---------|
|    19     |      |      |         |         |

Defects Found:
| Bug ID | TC ID | Rule Ref | Description | Severity | Status |
|--------|-------|----------|-------------|----------|--------|
|        |       |          |             |          |        |

Sign-off:
[ ] QC Lead Review: ___________
[ ] Security Review (if applicable): ___________
[ ] Ready for Release
```
